{"paragraphs":[{"title":"Initialize. Connect to S3 bucket","text":"%INTERPRETER_NAME\r\nimport org.apache.spark.sql._\r\n\r\nval workingBucket = \"s3a://S3_BUCKET\"\r\nval output_directory = \"processed_zeppelin_spark\"\r\nval sqlCtx = new SQLContext(sc)\r\nval hc = sc.hadoopConfiguration\r\nhc.set(\"hive.execution.engine\", \"mr\")\r\n","user":"anonymous","dateUpdated":"2017-03-29T11:21:04+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"results":{},"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490786343800_-1654710597","id":"20170120-150939_1549034406","dateCreated":"2017-03-29T11:19:03+0000","dateStarted":"2017-03-29T11:21:04+0000","dateFinished":"2017-03-29T11:21:05+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4983"},{"title":"process CARRIERS data","text":"%INTERPRETER_NAME\ndef bucketPath(path: String) = {\n    s\"$workingBucket/$path\"\n}\ndef fullPath(path: String) = {\n    s\"$workingBucket/$output_directory/$path\"\n}\n\nval carriers = sqlCtx.read.\n                        format(\"com.databricks.spark.csv\").\n                        //option(\"inferSchema\", \"true\").\n                        option(\"header\", \"true\").\n                        load(bucketPath(\"carriers.csv\"))\ncarriers.write.mode(SaveMode.Overwrite).parquet(fullPath(\"carriers/\"))\ncarriers.createOrReplaceTempView(\"carriers\")\ncarriers.show(20)","user":"anonymous","dateUpdated":"2017-03-29T11:21:08+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"results":{},"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490786343800_-1654710597","id":"20170120-151133_1703773120","dateCreated":"2017-03-29T11:19:03+0000","dateStarted":"2017-03-29T11:21:08+0000","dateFinished":"2017-03-29T11:21:13+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4984"},{"title":"process AIRPORTS data","text":"%INTERPRETER_NAME\nval airports = sqlCtx.read.\n                        format(\"com.databricks.spark.csv\").\n                        //option(\"inferSchema\", \"true\").\n                        option(\"header\", \"true\").\n                        load(bucketPath(\"airports.csv\"))\nairports.write.mode(SaveMode.Overwrite).parquet(fullPath(\"airports/\"))\nairports.createOrReplaceTempView(\"airports\")\nairports.show(20)","user":"anonymous","dateUpdated":"2017-03-29T11:21:15+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"results":{},"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490786343801_-1655095346","id":"20170124-212934_103706299","dateCreated":"2017-03-29T11:19:03+0000","dateStarted":"2017-03-29T11:21:15+0000","dateFinished":"2017-03-29T11:21:19+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4985"},{"title":"process FLIGHTS data (~100Mb)","text":"%INTERPRETER_NAME\nimport sqlCtx.implicits._\n\nval flights_w_na = sqlCtx.read.\n                        format(\"com.databricks.spark.csv\").\n                        //option(\"inferSchema\", \"true\").\n                        option(\"header\", \"true\").\n                        option(\"nullValue\", \"NA\").\n                        load(bucketPath(\"2008.csv.bz2\"))\nval flights = flights_w_na.na.fill(0)\nflights.write.mode(SaveMode.Overwrite).parquet(fullPath(\"flights/\"))\nflights.createOrReplaceTempView(\"flights\")\nflights.select($\"ArrDelay\",$\"CarrierDelay\",$\"WeatherDelay\",$\"Distance\").show(20)","user":"anonymous","dateUpdated":"2017-03-29T11:21:26+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"results":{},"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490786343801_-1655095346","id":"20170124-214513_801806968","dateCreated":"2017-03-29T11:19:03+0000","dateStarted":"2017-03-29T11:21:26+0000","dateFinished":"2017-03-29T11:22:37+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4986"},{"text":"%INTERPRETER_NAME\n","user":"anonymous","dateUpdated":"2017-03-29T11:21:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490786486021_1234951212","id":"20170329-112126_5229654","dateCreated":"2017-03-29T11:21:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4987"}],"name":"Scala","id":"2CF1ENGUT","angularObjects":{"2C6RJRBD2:shared_process":[],"2C6RJRBD1:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}
